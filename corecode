#visualisation and processing modules
import matplotlib.pyplot as plt
import matplotlib as mpl
import seaborn as sns
import numpy as np
import pandas as pd
import plotly as plt
import requests
import sklearn
import datetime

#threading modules
import logging
import threading
import time
import concurrent.futures

#__

airport=pd.read_csv('AComp_Passenger_data_no_error(1).csv')
latlong=pd.read_csv('Top30_airports_LatLong(1).csv')
#__

#Name airport columns
airport.columns=["Passenger_ID", "Flight_ID", "From_Airport_Code", "To_Airport_Code","Departure_Time", "Duration"]

#__

#Basic overview of latitude and logitude dataset
print(latlong)

#__

###Column of all the airport codes
airport1=airport.loc[:,'From_Airport_Code']
#print(airport1)

#__

###Column of all the airport codes
airport1=airport.loc[:,'From_Airport_Code']
#print(airport1)

#__

#Output: <FAA Code, x> where x is count
#Need to change this so FAA code is replace with airport code
airportkeys = list()
dictionarylist = []


def map(separator=','):
  #Map Segment
  data = read_input(airport1)
  for words in data:
    dictkey= {word: 1 for word in words}
    dictionarylist.append(dict(dictkey))
  
def main():
  #map + reduce segments
  map()
  #reducer()



#Reduce segment
def reducer(separator=','):
  #sorter segment, sorts dictionaries alphabetically
  dictionary= sorted(dictionarylist, key= lambda d : list(d.keys()))
  #dictionary=dictionarylist.sort(key=lambda x: x[1], reverse=False)
  for key, value in dictionary[0].items():
    current_airport,current_count = [str(key),0] 

  #current_airport = dictionarylist[0].keys()
  #current_count = dictionarylist[0].values()
  for dictionary in dictionary:
    for key, value in dictionary.items():
      if key ==current_airport:
        current_count= current_count+value
      else:
        airportkey= {current_airport: current_count}
        airportlist.append(dict(airportkey))
        current_airport = key
        current_count = value

def main():
  #map + reduce segments
  map()
  
  reducer()


if __name__ == "__main__":
  main()
print(dictionary)
print(airportlist)
